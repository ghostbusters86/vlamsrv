var Skoring=function(){var a={peserta:baseURL+"user/skoring/getPeserta",content:baseURL+"user/skoring/content",image:baseURL+"user/soal/image",save:baseURL+"api/v2/skoring/save"};return{soal:[],content:"",current:{},params:{mapel_id:"",tingkat:"",babon:""},start:function(){var s=this;$(window).keydown(function(a){var s=a.which;$(".soal-container").length>0&&(37==s?$("#skoring-back").click():39==s&&$("#skoring-next").click())}),s.params={tes_id:$(".params").attr("data-tes"),soal_id:$(".params").attr("data-soal")},$.ajax({dataType:"json",type:"POST",url:a.peserta,data:s.params,success:function(a){a.success&&(s.soal=a.rows,$.each(s.soal,function(a,s){var t=$("<a>",{href:"javascript:void(0)",class:"soal-nomor-link","data-index":a,"data-no":s.nomor,"data-siswa-id":s.siswa_id}).text(s.nomor);t.append($("<span>",{class:"soal-nomor-link-jawab"}).text(s.essay_point)),(t=$("<li>").append(t)).appendTo("#nomor-peserta")}),$("#nomor-peserta a").click(function(a){var t=$(this),n=$(this).data("index"),e=s.soal[n];s.current=e,$("#page").text(e.nomor),$("#skoring-username").text(e.username),$(".soal-nomor-link").removeClass("active"),$(this).addClass("active"),$("#skoring-next").show(),$("#skoring-selesai").show(),$("#btnLogout").hide(),s.loadSoal(e,t)}),$("#nomor-peserta a:first").click(),$("#page-count").text(s.soal.length),s.eventListener())}})},loadSoal:function(s,t){var n=this;$.ajax({dataType:"json",type:"POST",url:a.content,data:{soal_id:s.soal_id,siswa_id:s.siswa_id,tes_id:s.tes_id},success:function(s){if(s.success){var e=$("<div>",{class:"soal-container mce-content-body"});if("1"==s.images_soal){var i=$("<img>",{src:app.uri(a.image,{mapel_id:s.mapel_id,tingkat:s.tingkat,filename:s.filename}),onload:"this.width/=1.3;this.onload=null;",alt:"Loading Images........"});e.html(i),$("#content").html(e)}else $("#content").html(e.html(s.pertanyaan));var o=$("<div>",{class:"jawaban-img-container"}),r=$("<div>",{class:"jawaban-img-border"}),c=$("<div>",{class:"jawaban-img-title",text:"SKOR"}),l=$("<div>",{class:"jawaban-img-wrapper"});o.append(r.append(c).append(l));for(var d=0;d<=10;d++)l.append($("<a>",{href:"javascript:;",class:"jawaban-mce jawaban",text:d,"data-huruf":d}));e.append(o),e.find("a.jawaban").removeClass("active"),e.find('a.jawaban[data-huruf="'+t.find("span").text()+'"]').addClass("active"),e.find("textarea").each(function(a,t){$(this).val();var n=$("<div>",{class:"jawaban-essay",style:"min-height: 200px",html:s.answer});$(this).replaceWith(n)}),e.find('input[type="text"]').each(function(a,t){$(this).val();var n=$("<span>",{class:"jawaban-isian",html:s.answer});$(this).replaceWith(n)}),$(".jawaban").off("click"),$(".jawaban").on("click",function(){n.save($(this).data("huruf"))})}}})},eventListener:function(){var a=this;$("#font-small").click(function(){$(".soal-container").removeClass("zoom-1"),$(".soal-container").removeClass("zoom-2")}),$("#font-middle").click(function(){$(".soal-container").addClass("zoom-1"),$(".soal-container").removeClass("zoom-2")}),$("#font-big").click(function(){$(".soal-container").removeClass("zoom-1"),$(".soal-container").addClass("zoom-2")}),$("#skoring-back").click(function(){var a=$("#page").text()-1,s=a-1;$("#page-count").text();a>0&&$("#nomor-peserta a:eq("+s+")").click()}),$("#skoring-next").click(function(){var a=$("#page").text()-1+1;a<$("#page-count").text()&&$("#nomor-peserta a:eq("+a+")").click()}),$("#skoring-selesai").click(function(){$(this).hasClass("btn-save")?a.onSave():parent.location=baseURL+"user/skoring/tes-"+a.params.tes_id}),$("#right-nav-button").click(function(){$("#right-nav").hasClass("show")?($("#right-nav").removeClass("show"),$(this).find(".fa").removeClass("fa-chevron-right"),$(this).find(".fa").addClass("fa-chevron-left")):($("#right-nav").addClass("show"),$(this).find(".fa").removeClass("fa-chevron-left"),$(this).find(".fa").addClass("fa-chevron-right"))})},save:function(s){var t=$("#nomor-peserta"),n=t.find("a.active").data("siswa-id");$.ajax({dataType:"json",type:"POST",url:a.save,data:{siswa_id:n,soal_id:this.params.soal_id,tes_id:this.params.tes_id,skor:s},success:function(a){a.success?($("a.jawaban").removeClass("active"),$('a.jawaban[data-huruf="'+s+'"]').addClass("active"),t.find("a.active").find("span").text(s),t.find("a.active").addClass("isi"),$("#notifikasi").text(a.msg),$("#notifikasi").addClass("show")):($("#notifikasi").text(a.msg),$("#notifikasi").addClass("show")),setTimeout(function(){$("#notifikasi").removeClass("show")},3e3)}})},show:function(){this.soal=[],this.start()}}}();Skoring.show();